# Requirements Quality Checklist: Customer Success Digital FTE

**Purpose**: Validate the quality, completeness, clarity, and measurability of requirements
across spec.md, plan.md, and tasks.md. This is a "unit test suite for requirements" —
each item tests whether the *written requirements* are complete, clear, consistent,
and objectively verifiable. It does NOT test implementation behaviour.
**Created**: 2026-02-25
**Feature**: [spec.md](../spec.md) | [plan.md](../plan.md) | [tasks.md](../tasks.md)
**Generated by**: `/sp.checklist` | Informed by: `sp.analyze` findings (2026-02-25)

---

## Requirement Completeness

- [ ] CHK001 Are response formatting hard limits specified for ALL three channels with exact values — Email (≤ 500 words), WhatsApp (≤ 300 chars preferred / ≤ 1600 hard), Web Form (≤ 300 words)? [Completeness, Spec §FR-005, Constitution §I]
- [ ] CHK002 Are requirements defined for the delivery failure path — what system action is mandated when Gmail/Twilio send fails *after* the agent generates a response? [Completeness, Gap — Spec §FR-014]
- [ ] CHK003 Are requirements specified for the DLQ (`fte.dlq`) consumer — who/what processes DLQ messages and what remediation action is required? [Completeness, Gap — Constitution §V]
- [ ] CHK004 Are requirements defined for the scheduled daily report generation mechanism — is a specific trigger (cron, APScheduler, k8s CronJob) and time (08:00 local) mandated? [Completeness, Gap — Spec §SC-008]
- [ ] CHK005 Are knowledge base maintenance requirements specified — initial seeding, incremental update triggers, and re-seeding procedures? [Completeness, Gap — Spec §FR-003]
- [ ] CHK006 Are requirements defined for what constitutes a conversation thread — specifically how the 24-hour window is calculated (absolute from first message vs rolling)? [Completeness, Spec §US3-AC3]
- [ ] CHK007 Are authentication/verification requirements for the Gmail Pub/Sub webhook endpoint specified (e.g., Google service account token validation)? [Completeness, Gap]
- [ ] CHK008 Are requirements for WhatsApp messages exceeding 1600 characters fully specified — split into multiple messages, truncate with notice, or reject? [Completeness, Spec §FR-005]

---

## Requirement Clarity

- [ ] CHK009 Is "sentiment score < 0.3" (escalation trigger) defined with its measurement model/algorithm — which NLP model produces this score and on what input? [Clarity, Spec §US4, Constitution §VI]
- [ ] CHK010 Is "< 3 seconds processing time" clarified with a specific percentile target — p50, p95, or p99? [Clarity, Spec §SC-002, plan.md §Performance Goals]
- [ ] CHK011 Is the "2 failed searches" escalation trigger defined unambiguously — 2 consecutive empty KB results within a single conversation, or cumulative across all searches? [Clarity, Spec §US2-AC4, Constitution §VI]
- [ ] CHK012 Is "estimated follow-up time" in escalation notifications (FR-009) defined with a concrete value rather than left to agent discretion? [Clarity, Spec §FR-009]
- [ ] CHK013 Is "formal tone" for email responses specified with measurable criteria beyond greeting and signature (e.g., prohibited contractions, required salutation format)? [Clarity, Spec §FR-005]
- [ ] CHK014 Is the 24-hour conversation continuity window (US3-AC3) defined for edge cases where it straddles midnight or timezone boundaries? [Clarity, Spec §US3]
- [ ] CHK015 Is the distinction between `ticket` and `conversation` entities explicitly defined — can one ticket span multiple conversations, or is the relationship always 1:1? [Clarity, Spec §Key Entities]
- [ ] CHK016 Is "average sentiment score" in daily reports (FR-011) defined as mean of per-message scores, per-conversation final scores, or per-conversation averages? [Clarity, Spec §FR-011]

---

## Requirement Consistency

- [ ] CHK017 Are WhatsApp character limits consistent across all documents — Constitution §IX ("≤ 300 preferred, ≤ 1600 hard"), Spec §FR-005 ("concise"), tasks.md T028 ("truncate to 297 if > 300")? [Consistency]
- [ ] CHK018 Is the model selection requirement consistent — Constitution §X mandates "GPT-4o" but production uses `meta-llama/llama-4-scout-17b-16e-instruct` via Groq? Does spec.md reference ADR-001 or require a constitution amendment? [Consistency, Conflict — ADR-001]
- [ ] CHK019 Is the Kafka requirement consistent — Constitution §V mandates "ALL inter-service communication MUST flow through Kafka" but a 5-second bypass fallback exists? Is this captured in spec, plan, or ADR-002? [Consistency, Conflict — ADR-002]
- [ ] CHK020 Are escalation triggers consistent between Constitution §VI (7 triggers) and Spec §US4 (4 acceptance scenarios) — are all 7 constitutional triggers covered or explicitly out-of-scope? [Consistency, Spec §US4 vs Constitution §VI]
- [ ] CHK021 Is the `VECTOR(1536)` embedding dimension consistent across Constitution §IV, plan.md (text-embedding-3-small), and the actual production seeding/query pipeline? [Consistency, Gap — sp.analyze M3]

---

## Acceptance Criteria Quality

- [ ] CHK022 Can SC-003 ("≥ 85% accuracy on test set of 50+ tickets") be objectively measured without a defined test runner, scoring methodology, and ground-truth labels? [Measurability, Spec §SC-003]
- [ ] CHK023 Can SC-005 ("≥ 95% cross-channel customer ID accuracy") be verified without a labeled dataset of cross-channel identity pairs with known correct matches? [Measurability, Spec §SC-005]
- [ ] CHK024 Can SC-009 ("customer sentiment does not decline over successive interactions") be measured without a baseline, time window, and trend detection algorithm? [Measurability, Spec §SC-009]
- [ ] CHK025 Is SC-007 ("99.9% availability") defined with a measurement window, downtime definition (per-channel vs system-wide), and SLO calculation method? [Measurability, Spec §SC-007]
- [ ] CHK026 Are US1 acceptance criteria (AC1–AC3, channel confirmation) testable independently without requiring the full AI agent stack to be running? [Measurability, Spec §US1]

---

## Scenario Coverage

- [ ] CHK027 Are requirements specified for the Kafka-unavailable scenario — does the system reject requests, enter a defined degraded mode, or bypass Kafka silently? [Coverage, Gap — sp.analyze C2, ADR-002]
- [ ] CHK028 Are requirements defined for concurrent ticket submission by the same customer across two channels simultaneously? [Coverage, Spec §Edge Cases]
- [ ] CHK029 Are requirements specified for shared phone number (family plan) scenarios — how does the system handle ambiguous WhatsApp identity? [Coverage, Spec §Edge Cases]
- [ ] CHK030 Are requirements defined for what happens when `search_knowledge_base` returns results but the agent judges them irrelevant — does this count as a "failed search"? [Coverage, Spec §US2-AC4]
- [ ] CHK031 Are requirements specified for Twilio delivery status callbacks — what action is mandated for "failed" status after outbound WhatsApp messages? [Coverage, Gap — Spec §FR-014]
- [ ] CHK032 Are requirements defined for Gmail API quota exhaustion or OAuth token expiry scenarios? [Coverage, Gap]

---

## Edge Case Coverage

- [ ] CHK033 Is the blank/whitespace-only message edge case fully specified — is a ticket still created, what response is given, and does this align with Constitution §VII test 1? [Edge Case, Spec §Edge Cases, Constitution §VII]
- [ ] CHK034 Is the "same email via web form AND Gmail simultaneously" edge case specified — is deduplication required within what time window? [Edge Case, Spec §Edge Cases]
- [ ] CHK035 Is the "channel switch mid-resolution" scenario (email → WhatsApp) specified — does the prior conversation stay open, merge, or close? [Edge Case, Spec §Edge Cases]
- [ ] CHK036 Are requirements defined for web form email validation passing but email being undeliverable (bounce) when sending confirmation? [Edge Case, Gap]

---

## Non-Functional Requirements Quality

- [ ] CHK037 Is the "< 1 GB memory per pod" constraint (plan.md §Constraints) reflected in spec.md NFRs or only in plan.md? [Completeness, Gap — plan.md §Constraints]
- [ ] CHK038 Are CORS requirements specified with an explicit allowed-origins list — is `*` permitted in any environment? [Security, Gap — tasks.md T059]
- [ ] CHK039 Are structured logging requirements (Constitution §III) specified with an explicit JSON schema — field names, required fields, log levels per event type? [Completeness, Gap — Constitution §III]
- [ ] CHK040 Are database connection pool requirements specified for production load — min/max connections, idle timeout, and retry behaviour under exhaustion? [Completeness, Gap]

---

## Dependencies & Assumptions

- [ ] CHK041 Is the assumption "human escalation team is available" validated with an SLA, contact method, and notification channel? [Assumption, Spec §Assumptions]
- [ ] CHK042 Is the dependency on OpenAI `text-embedding-3-small` for KB seeding vs fastembed for queries explicitly documented with confirmed dimension alignment? [Dependency, Gap — sp.analyze M3]
- [ ] CHK043 Is the assumption "product documentation available in structured format before go-live" validated with a specific format requirement? [Assumption, Spec §Assumptions]
- [ ] CHK044 Are Twilio API rate limits and WhatsApp Business throughput constraints documented as hard constraints? [Dependency, Gap]

---

## Notes

- Check items off as completed: `[x]`
- Add inline findings: `[x] CHK001 — PASS: limits defined in FR-005 and Constitution §I`
- **Conflict items** (CHK017–CHK021): require spec amendment, plan update, or ADR reference
- Items marked **[Gap]**: add to spec.md or explicitly mark out-of-scope
- Items marked **[Consistency/Conflict]**: require cross-document alignment before sign-off
- Related ADRs: `history/adr/001-groq-llama-model-substitution.md`, `history/adr/002-kafka-bypass-fallback-pattern.md`

**Total items**: 44 (CHK001–CHK044)
**Critical items** (blocks release): CHK018, CHK019, CHK022, CHK023, CHK027
